<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Formatted Notes to Table</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0d1b0d;
      color: #c5f7c5;
      padding: 20px;
    }

    h2 {
      color: #7fff7f;
    }

    .hint {
      font-size: 0.95em;
      color: #8ff98f;
      margin-bottom: 10px;
    }

    #inputNotes {
      width: 100%;
      min-height: 200px;
      border: 1px solid #2d4f2d;
      background-color: #1a2e1a;
      color: #d0ffd0;
      padding: 12px;
      margin-bottom: 12px;
      overflow-y: auto;
      border-radius: 6px;
    }

    #inputNotes:focus {
      outline: none;
      border-color: #3fcf3f;
    }

    button {
      background-color: #2e8b57;
      color: #ffffff;
      border: none;
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.2s;
    }

    button:hover {
      background-color: #3fae6f;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #1f311f;
      color: #c5f7c5;
    }

    th, td {
      border: 1px solid #3a5e3a;
      padding: 10px;
      text-align: left;
    }

    th {
      background: #2c4d2c;
      color: #aafcaa;
    }

    td {
      background-color: #162516;
    }

    ::selection {
      background: #4ae04a;
      color: #001100;
    }
  </style>
</head>
<body>

  <h2>Formatted Notes to Table</h2>
  <div class="hint">
    <strong>Word count rules (adjustable):</strong> <br>
    <label>A: <input type="number" id="colAmin" value="1" min="1" style="width:40px;"> - <input type="number" id="colAmax" value="1" min="1" style="width:40px;"></label>
    <label>B: <input type="number" id="colBmin" value="2" min="1" style="width:40px;"> - <input type="number" id="colBmax" value="4" min="1" style="width:40px;"></label>
    <label>C: <input type="number" id="colCmin" value="5" min="1" style="width:40px;"> - <input type="number" id="colCmax" value="10" min="1" style="width:40px;"></label>
    <label>D: <input type="number" id="colDmin" value="11" min="1" style="width:40px;"> - <input type="number" id="colDmax" value="20" min="1" style="width:40px;"></label>
    <label>E: <input type="number" id="colEmin" value="21" min="1" style="width:40px;"> - âˆž</label>
    <br><span style="font-size:0.9em;">Each row displays up to 10 words. Longer lines are split into multiple rows.</span>
  </div>

  <div id="inputNotes" contenteditable="true" placeholder="Paste formatted notes here..."></div>
  <button onclick="generateTable()">Generate Table</button>

  <table id="outputTable">
    <thead>
      <tr>
        <th>Big Heading (A)</th>
        <th>Heading (B)</th>
        <th>Sub Heading (C)</th>
        <th>Contents (D)</th>
        <th>Sub Contents (E)</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    function getWordRanges() {
      return {
        A: [parseInt(document.getElementById('colAmin').value), parseInt(document.getElementById('colAmax').value)],
        B: [parseInt(document.getElementById('colBmin').value), parseInt(document.getElementById('colBmax').value)],
        C: [parseInt(document.getElementById('colCmin').value), parseInt(document.getElementById('colCmax').value)],
        D: [parseInt(document.getElementById('colDmin').value), parseInt(document.getElementById('colDmax').value)],
        E: [parseInt(document.getElementById('colEmin').value), Infinity]
      };
    }

    function getColumnIndex(wordCount, ranges) {
      if (wordCount >= ranges.A[0] && wordCount <= ranges.A[1]) return 0;
      if (wordCount >= ranges.B[0] && wordCount <= ranges.B[1]) return 1;
      if (wordCount >= ranges.C[0] && wordCount <= ranges.C[1]) return 2;
      if (wordCount >= ranges.D[0] && wordCount <= ranges.D[1]) return 3;
      if (wordCount >= ranges.E[0]) return 4;
      return 4;
    }

    function cleanWords(text) {
      // Remove symbols/punctuation for word splitting and counting
      return text.replace(/[^\w\s]|_/g, '').replace(/\s+/g, ' ');
    }

    function generateTable() {
      const content = document.getElementById("inputNotes").innerText;
      const lines = content.split(/\n|\r/);
      const tbody = document.querySelector("#outputTable tbody");
      tbody.innerHTML = "";
      const ranges = getWordRanges();
      lines.forEach(rawLine => {
        const text = rawLine.trim();
        if (!text) return;
        // Clean for word splitting/counting, but keep original for display
        const cleanText = cleanWords(text);
        const words = cleanText.split(/\s+/).filter(Boolean);
        let idx = 0;
        let firstChunk = true;
        while (idx < words.length) {
          const chunkWords = words.slice(idx, idx + 10);
          // Find the corresponding original words for display (to preserve formatting)
          // This is a best-effort: split the original text by spaces and match the count
          let displayChunk = text.split(/\s+/).slice(idx, idx + 10).join(' ');
          const wordCount = chunkWords.length;
          let colIndex;
          if (firstChunk) {
            colIndex = getColumnIndex(wordCount, ranges);
          } else {
            colIndex = 4; // Always column E for subsequent chunks
          }
          const row = document.createElement("tr");
          for (let i = 0; i < 5; i++) {
            const td = document.createElement("td");
            if (i === colIndex) td.textContent = displayChunk;
            row.appendChild(td);
          }
          tbody.appendChild(row);
          idx += 10;
          firstChunk = false;
        }
      });
    }
  </script>

</body>
</html>
